<!DOCTYPE html>
<!-- saved from url=(0071)https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session -->
<html lang="en" class="mdl-js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Recommending Products Using Cloud SQL and Spark | Qwiklabs</title>
<script type="text/javascript" id="www-widgetapi-script" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/www-widgetapi.js.download" async=""></script><script type="text/javascript" async="" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/js"></script><script type="text/javascript" async="" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/iframe_api"></script><script type="text/javascript" async="" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/analytics.js.download"></script><script type="text/javascript" async="" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/js(1)"></script><script type="text/javascript" async="" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/analytics.min.js.download"></script><script type="text/javascript" async="" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/recaptcha__en.js.download" crossorigin="anonymous" integrity="sha384-f1gfYQgq4OmhARgCSe1q7WV7tIcPpqu0qD+jYdSEMczD1YXPg0ibdIzvD/fZzwKc"></script><script type="text/javascript" async="" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/recaptcha__en.js.download" crossorigin="anonymous" integrity="sha384-f1gfYQgq4OmhARgCSe1q7WV7tIcPpqu0qD+jYdSEMczD1YXPg0ibdIzvD/fZzwKc"></script><script async="" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/gtm.js.download"></script><script>
//<![CDATA[
window.gon={};gon.current_user={"firstname":"Bishnu","lastname":"Poudel","fullname":"Bishnu Poudel","company":"Coursera","email":"replytobishnu@yahoo.com","origin":"googlecoursera-run, lti-coursera","subscriptions":0,"id":"024695ed22bf9de3de73cb0272a95fe9","qlCreatedAt":"2021-06-09 06:07:35 UTC","optIn":null,"current_organization_id":null,"current_organization_role":null};gon.segment="j4Im8pqIko0Lxq4wVVZWMPMM0EroHUvb";gon.deployment="googlecoursera-run";gon.content={"type":"Lab","id":1794,"name":"Recommending Products Using Cloud SQL and Spark"};
//]]>
</script>
<script>
  dataLayer = [
    {user: gon.current_user},
    {content: gon.content}
  ];
</script>
<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer',"GTM-TQR88QK");
</script>
<script>
  EVENT_SOURCE_BASE_URL = "https://googlecoursera-run.qwiklabs.com/nchan-sub?id=";
</script>
<script src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/webcomponents-loader-408088dc333247a761de5f2b2a4ba1cabd2bc36579f83ba92a559eb3682a9b77.js.download"></script>
<script src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/vendor-45d462772c30000424907184f70c7157e95fb6227698d1671c5051818a6f60d8.js.download"></script>
<script src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/application-33b23f92df5102bcb0f4f8547379eb35a7efe4c3300b66e43ff8f50e5fad1cf3.js.download"></script>
<script src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/hallofmirrors-19e951a685fa8811a8b36d459ec6b1b160a131261e98c781f18e69535f0d9a9e.js.download"></script>
<custom-style>
  <style is="custom-style">[hidden] {
  display: none !important;
}

</style>
</custom-style>
<custom-style>
  <style is="custom-style">html {
  --layout_-_display:  flex;;

      --layout-inline_-_display:  inline-flex;;

      --layout-horizontal_-_display:  var(--layout_-_display); --layout-horizontal_-_-ms-flex-direction:  row; --layout-horizontal_-_-webkit-flex-direction:  row; --layout-horizontal_-_flex-direction:  row;;

      --layout-horizontal-reverse_-_display:  var(--layout_-_display); --layout-horizontal-reverse_-_-ms-flex-direction:  row-reverse; --layout-horizontal-reverse_-_-webkit-flex-direction:  row-reverse; --layout-horizontal-reverse_-_flex-direction:  row-reverse;;

      --layout-vertical_-_display:  var(--layout_-_display); --layout-vertical_-_-ms-flex-direction:  column; --layout-vertical_-_-webkit-flex-direction:  column; --layout-vertical_-_flex-direction:  column;;

      --layout-vertical-reverse_-_display:  var(--layout_-_display); --layout-vertical-reverse_-_-ms-flex-direction:  column-reverse; --layout-vertical-reverse_-_-webkit-flex-direction:  column-reverse; --layout-vertical-reverse_-_flex-direction:  column-reverse;;

      --layout-wrap_-_-ms-flex-wrap:  wrap; --layout-wrap_-_-webkit-flex-wrap:  wrap; --layout-wrap_-_flex-wrap:  wrap;;

      --layout-wrap-reverse_-_-ms-flex-wrap:  wrap-reverse; --layout-wrap-reverse_-_-webkit-flex-wrap:  wrap-reverse; --layout-wrap-reverse_-_flex-wrap:  wrap-reverse;;

      --layout-flex-auto_-_-ms-flex:  1 1 auto; --layout-flex-auto_-_-webkit-flex:  1 1 auto; --layout-flex-auto_-_flex:  1 1 auto;;

      --layout-flex-none_-_-ms-flex:  none; --layout-flex-none_-_-webkit-flex:  none; --layout-flex-none_-_flex:  none;;

      --layout-flex_-_-ms-flex:  1 1 0.000000001px; --layout-flex_-_-webkit-flex:  1; --layout-flex_-_flex:  1; --layout-flex_-_-webkit-flex-basis:  0.000000001px; --layout-flex_-_flex-basis:  0.000000001px;;

      --layout-flex-2_-_-ms-flex:  2; --layout-flex-2_-_-webkit-flex:  2; --layout-flex-2_-_flex:  2;;

      --layout-flex-3_-_-ms-flex:  3; --layout-flex-3_-_-webkit-flex:  3; --layout-flex-3_-_flex:  3;;

      --layout-flex-4_-_-ms-flex:  4; --layout-flex-4_-_-webkit-flex:  4; --layout-flex-4_-_flex:  4;;

      --layout-flex-5_-_-ms-flex:  5; --layout-flex-5_-_-webkit-flex:  5; --layout-flex-5_-_flex:  5;;

      --layout-flex-6_-_-ms-flex:  6; --layout-flex-6_-_-webkit-flex:  6; --layout-flex-6_-_flex:  6;;

      --layout-flex-7_-_-ms-flex:  7; --layout-flex-7_-_-webkit-flex:  7; --layout-flex-7_-_flex:  7;;

      --layout-flex-8_-_-ms-flex:  8; --layout-flex-8_-_-webkit-flex:  8; --layout-flex-8_-_flex:  8;;

      --layout-flex-9_-_-ms-flex:  9; --layout-flex-9_-_-webkit-flex:  9; --layout-flex-9_-_flex:  9;;

      --layout-flex-10_-_-ms-flex:  10; --layout-flex-10_-_-webkit-flex:  10; --layout-flex-10_-_flex:  10;;

      --layout-flex-11_-_-ms-flex:  11; --layout-flex-11_-_-webkit-flex:  11; --layout-flex-11_-_flex:  11;;

      --layout-flex-12_-_-ms-flex:  12; --layout-flex-12_-_-webkit-flex:  12; --layout-flex-12_-_flex:  12;;

      

      --layout-start_-_-ms-flex-align:  start; --layout-start_-_-webkit-align-items:  flex-start; --layout-start_-_align-items:  flex-start;;

      --layout-center_-_-ms-flex-align:  center; --layout-center_-_-webkit-align-items:  center; --layout-center_-_align-items:  center;;

      --layout-end_-_-ms-flex-align:  end; --layout-end_-_-webkit-align-items:  flex-end; --layout-end_-_align-items:  flex-end;;

      --layout-baseline_-_-ms-flex-align:  baseline; --layout-baseline_-_-webkit-align-items:  baseline; --layout-baseline_-_align-items:  baseline;;

      

      --layout-start-justified_-_-ms-flex-pack:  start; --layout-start-justified_-_-webkit-justify-content:  flex-start; --layout-start-justified_-_justify-content:  flex-start;;

      --layout-center-justified_-_-ms-flex-pack:  center; --layout-center-justified_-_-webkit-justify-content:  center; --layout-center-justified_-_justify-content:  center;;

      --layout-end-justified_-_-ms-flex-pack:  end; --layout-end-justified_-_-webkit-justify-content:  flex-end; --layout-end-justified_-_justify-content:  flex-end;;

      --layout-around-justified_-_-ms-flex-pack:  distribute; --layout-around-justified_-_-webkit-justify-content:  space-around; --layout-around-justified_-_justify-content:  space-around;;

      --layout-justified_-_-ms-flex-pack:  justify; --layout-justified_-_-webkit-justify-content:  space-between; --layout-justified_-_justify-content:  space-between;;

      --layout-center-center_-_-ms-flex-align:  var(--layout-center_-_-ms-flex-align); --layout-center-center_-_-webkit-align-items:  var(--layout-center_-_-webkit-align-items); --layout-center-center_-_align-items:  var(--layout-center_-_align-items); --layout-center-center_-_-ms-flex-pack:  var(--layout-center-justified_-_-ms-flex-pack); --layout-center-center_-_-webkit-justify-content:  var(--layout-center-justified_-_-webkit-justify-content); --layout-center-center_-_justify-content:  var(--layout-center-justified_-_justify-content);;

      

      --layout-self-start_-_-ms-align-self:  flex-start; --layout-self-start_-_-webkit-align-self:  flex-start; --layout-self-start_-_align-self:  flex-start;;

      --layout-self-center_-_-ms-align-self:  center; --layout-self-center_-_-webkit-align-self:  center; --layout-self-center_-_align-self:  center;;

      --layout-self-end_-_-ms-align-self:  flex-end; --layout-self-end_-_-webkit-align-self:  flex-end; --layout-self-end_-_align-self:  flex-end;;

      --layout-self-stretch_-_-ms-align-self:  stretch; --layout-self-stretch_-_-webkit-align-self:  stretch; --layout-self-stretch_-_align-self:  stretch;;

      --layout-self-baseline_-_-ms-align-self:  baseline; --layout-self-baseline_-_-webkit-align-self:  baseline; --layout-self-baseline_-_align-self:  baseline;;

      

      --layout-start-aligned_-_-ms-flex-line-pack:  start; --layout-start-aligned_-_-ms-align-content:  flex-start; --layout-start-aligned_-_-webkit-align-content:  flex-start; --layout-start-aligned_-_align-content:  flex-start;;

      --layout-end-aligned_-_-ms-flex-line-pack:  end; --layout-end-aligned_-_-ms-align-content:  flex-end; --layout-end-aligned_-_-webkit-align-content:  flex-end; --layout-end-aligned_-_align-content:  flex-end;;

      --layout-center-aligned_-_-ms-flex-line-pack:  center; --layout-center-aligned_-_-ms-align-content:  center; --layout-center-aligned_-_-webkit-align-content:  center; --layout-center-aligned_-_align-content:  center;;

      --layout-between-aligned_-_-ms-flex-line-pack:  justify; --layout-between-aligned_-_-ms-align-content:  space-between; --layout-between-aligned_-_-webkit-align-content:  space-between; --layout-between-aligned_-_align-content:  space-between;;

      --layout-around-aligned_-_-ms-flex-line-pack:  distribute; --layout-around-aligned_-_-ms-align-content:  space-around; --layout-around-aligned_-_-webkit-align-content:  space-around; --layout-around-aligned_-_align-content:  space-around;;

      

      --layout-block_-_display:  block;;

      --layout-invisible_-_visibility:  hidden !important;;

      --layout-relative_-_position:  relative;;

      --layout-fit_-_position:  absolute; --layout-fit_-_top:  0; --layout-fit_-_right:  0; --layout-fit_-_bottom:  0; --layout-fit_-_left:  0;;

      --layout-scroll_-_-webkit-overflow-scrolling:  touch; --layout-scroll_-_overflow:  auto;;

      --layout-fullbleed_-_margin:  0; --layout-fullbleed_-_height:  100vh;;

      

      --layout-fixed-top_-_position:  fixed; --layout-fixed-top_-_top:  0; --layout-fixed-top_-_left:  0; --layout-fixed-top_-_right:  0;;

      --layout-fixed-right_-_position:  fixed; --layout-fixed-right_-_top:  0; --layout-fixed-right_-_right:  0; --layout-fixed-right_-_bottom:  0;;

      --layout-fixed-bottom_-_position:  fixed; --layout-fixed-bottom_-_right:  0; --layout-fixed-bottom_-_bottom:  0; --layout-fixed-bottom_-_left:  0;;

      --layout-fixed-left_-_position:  fixed; --layout-fixed-left_-_top:  0; --layout-fixed-left_-_bottom:  0; --layout-fixed-left_-_left:  0;;
}

</style>
</custom-style><style>[hidden] { display: none !important; }</style><custom-style>
  <style is="custom-style">html {
  --google-red-100: #f4c7c3;
      --google-red-300: #e67c73;
      --google-red-500: #db4437;
      --google-red-700: #c53929;

      --google-blue-100: #c6dafc;
      --google-blue-300: #7baaf7;
      --google-blue-500: #4285f4;
      --google-blue-700: #3367d6;

      --google-green-100: #b7e1cd;
      --google-green-300: #57bb8a;
      --google-green-500: #0f9d58;
      --google-green-700: #0b8043;

      --google-yellow-100: #fce8b2;
      --google-yellow-300: #f7cb4d;
      --google-yellow-500: #f4b400;
      --google-yellow-700: #f09300;

      --google-grey-100: #f5f5f5;
      --google-grey-300: #e0e0e0;
      --google-grey-500: #9e9e9e;
      --google-grey-700: #616161;

      

      --paper-red-50: #ffebee;
      --paper-red-100: #ffcdd2;
      --paper-red-200: #ef9a9a;
      --paper-red-300: #e57373;
      --paper-red-400: #ef5350;
      --paper-red-500: #f44336;
      --paper-red-600: #e53935;
      --paper-red-700: #d32f2f;
      --paper-red-800: #c62828;
      --paper-red-900: #b71c1c;
      --paper-red-a100: #ff8a80;
      --paper-red-a200: #ff5252;
      --paper-red-a400: #ff1744;
      --paper-red-a700: #d50000;

      --paper-pink-50: #fce4ec;
      --paper-pink-100: #f8bbd0;
      --paper-pink-200: #f48fb1;
      --paper-pink-300: #f06292;
      --paper-pink-400: #ec407a;
      --paper-pink-500: #e91e63;
      --paper-pink-600: #d81b60;
      --paper-pink-700: #c2185b;
      --paper-pink-800: #ad1457;
      --paper-pink-900: #880e4f;
      --paper-pink-a100: #ff80ab;
      --paper-pink-a200: #ff4081;
      --paper-pink-a400: #f50057;
      --paper-pink-a700: #c51162;

      --paper-purple-50: #f3e5f5;
      --paper-purple-100: #e1bee7;
      --paper-purple-200: #ce93d8;
      --paper-purple-300: #ba68c8;
      --paper-purple-400: #ab47bc;
      --paper-purple-500: #9c27b0;
      --paper-purple-600: #8e24aa;
      --paper-purple-700: #7b1fa2;
      --paper-purple-800: #6a1b9a;
      --paper-purple-900: #4a148c;
      --paper-purple-a100: #ea80fc;
      --paper-purple-a200: #e040fb;
      --paper-purple-a400: #d500f9;
      --paper-purple-a700: #aa00ff;

      --paper-deep-purple-50: #ede7f6;
      --paper-deep-purple-100: #d1c4e9;
      --paper-deep-purple-200: #b39ddb;
      --paper-deep-purple-300: #9575cd;
      --paper-deep-purple-400: #7e57c2;
      --paper-deep-purple-500: #673ab7;
      --paper-deep-purple-600: #5e35b1;
      --paper-deep-purple-700: #512da8;
      --paper-deep-purple-800: #4527a0;
      --paper-deep-purple-900: #311b92;
      --paper-deep-purple-a100: #b388ff;
      --paper-deep-purple-a200: #7c4dff;
      --paper-deep-purple-a400: #651fff;
      --paper-deep-purple-a700: #6200ea;

      --paper-indigo-50: #e8eaf6;
      --paper-indigo-100: #c5cae9;
      --paper-indigo-200: #9fa8da;
      --paper-indigo-300: #7986cb;
      --paper-indigo-400: #5c6bc0;
      --paper-indigo-500: #3f51b5;
      --paper-indigo-600: #3949ab;
      --paper-indigo-700: #303f9f;
      --paper-indigo-800: #283593;
      --paper-indigo-900: #1a237e;
      --paper-indigo-a100: #8c9eff;
      --paper-indigo-a200: #536dfe;
      --paper-indigo-a400: #3d5afe;
      --paper-indigo-a700: #304ffe;

      --paper-blue-50: #e3f2fd;
      --paper-blue-100: #bbdefb;
      --paper-blue-200: #90caf9;
      --paper-blue-300: #64b5f6;
      --paper-blue-400: #42a5f5;
      --paper-blue-500: #2196f3;
      --paper-blue-600: #1e88e5;
      --paper-blue-700: #1976d2;
      --paper-blue-800: #1565c0;
      --paper-blue-900: #0d47a1;
      --paper-blue-a100: #82b1ff;
      --paper-blue-a200: #448aff;
      --paper-blue-a400: #2979ff;
      --paper-blue-a700: #2962ff;

      --paper-light-blue-50: #e1f5fe;
      --paper-light-blue-100: #b3e5fc;
      --paper-light-blue-200: #81d4fa;
      --paper-light-blue-300: #4fc3f7;
      --paper-light-blue-400: #29b6f6;
      --paper-light-blue-500: #03a9f4;
      --paper-light-blue-600: #039be5;
      --paper-light-blue-700: #0288d1;
      --paper-light-blue-800: #0277bd;
      --paper-light-blue-900: #01579b;
      --paper-light-blue-a100: #80d8ff;
      --paper-light-blue-a200: #40c4ff;
      --paper-light-blue-a400: #00b0ff;
      --paper-light-blue-a700: #0091ea;

      --paper-cyan-50: #e0f7fa;
      --paper-cyan-100: #b2ebf2;
      --paper-cyan-200: #80deea;
      --paper-cyan-300: #4dd0e1;
      --paper-cyan-400: #26c6da;
      --paper-cyan-500: #00bcd4;
      --paper-cyan-600: #00acc1;
      --paper-cyan-700: #0097a7;
      --paper-cyan-800: #00838f;
      --paper-cyan-900: #006064;
      --paper-cyan-a100: #84ffff;
      --paper-cyan-a200: #18ffff;
      --paper-cyan-a400: #00e5ff;
      --paper-cyan-a700: #00b8d4;

      --paper-teal-50: #e0f2f1;
      --paper-teal-100: #b2dfdb;
      --paper-teal-200: #80cbc4;
      --paper-teal-300: #4db6ac;
      --paper-teal-400: #26a69a;
      --paper-teal-500: #009688;
      --paper-teal-600: #00897b;
      --paper-teal-700: #00796b;
      --paper-teal-800: #00695c;
      --paper-teal-900: #004d40;
      --paper-teal-a100: #a7ffeb;
      --paper-teal-a200: #64ffda;
      --paper-teal-a400: #1de9b6;
      --paper-teal-a700: #00bfa5;

      --paper-green-50: #e8f5e9;
      --paper-green-100: #c8e6c9;
      --paper-green-200: #a5d6a7;
      --paper-green-300: #81c784;
      --paper-green-400: #66bb6a;
      --paper-green-500: #4caf50;
      --paper-green-600: #43a047;
      --paper-green-700: #388e3c;
      --paper-green-800: #2e7d32;
      --paper-green-900: #1b5e20;
      --paper-green-a100: #b9f6ca;
      --paper-green-a200: #69f0ae;
      --paper-green-a400: #00e676;
      --paper-green-a700: #00c853;

      --paper-light-green-50: #f1f8e9;
      --paper-light-green-100: #dcedc8;
      --paper-light-green-200: #c5e1a5;
      --paper-light-green-300: #aed581;
      --paper-light-green-400: #9ccc65;
      --paper-light-green-500: #8bc34a;
      --paper-light-green-600: #7cb342;
      --paper-light-green-700: #689f38;
      --paper-light-green-800: #558b2f;
      --paper-light-green-900: #33691e;
      --paper-light-green-a100: #ccff90;
      --paper-light-green-a200: #b2ff59;
      --paper-light-green-a400: #76ff03;
      --paper-light-green-a700: #64dd17;

      --paper-lime-50: #f9fbe7;
      --paper-lime-100: #f0f4c3;
      --paper-lime-200: #e6ee9c;
      --paper-lime-300: #dce775;
      --paper-lime-400: #d4e157;
      --paper-lime-500: #cddc39;
      --paper-lime-600: #c0ca33;
      --paper-lime-700: #afb42b;
      --paper-lime-800: #9e9d24;
      --paper-lime-900: #827717;
      --paper-lime-a100: #f4ff81;
      --paper-lime-a200: #eeff41;
      --paper-lime-a400: #c6ff00;
      --paper-lime-a700: #aeea00;

      --paper-yellow-50: #fffde7;
      --paper-yellow-100: #fff9c4;
      --paper-yellow-200: #fff59d;
      --paper-yellow-300: #fff176;
      --paper-yellow-400: #ffee58;
      --paper-yellow-500: #ffeb3b;
      --paper-yellow-600: #fdd835;
      --paper-yellow-700: #fbc02d;
      --paper-yellow-800: #f9a825;
      --paper-yellow-900: #f57f17;
      --paper-yellow-a100: #ffff8d;
      --paper-yellow-a200: #ffff00;
      --paper-yellow-a400: #ffea00;
      --paper-yellow-a700: #ffd600;

      --paper-amber-50: #fff8e1;
      --paper-amber-100: #ffecb3;
      --paper-amber-200: #ffe082;
      --paper-amber-300: #ffd54f;
      --paper-amber-400: #ffca28;
      --paper-amber-500: #ffc107;
      --paper-amber-600: #ffb300;
      --paper-amber-700: #ffa000;
      --paper-amber-800: #ff8f00;
      --paper-amber-900: #ff6f00;
      --paper-amber-a100: #ffe57f;
      --paper-amber-a200: #ffd740;
      --paper-amber-a400: #ffc400;
      --paper-amber-a700: #ffab00;

      --paper-orange-50: #fff3e0;
      --paper-orange-100: #ffe0b2;
      --paper-orange-200: #ffcc80;
      --paper-orange-300: #ffb74d;
      --paper-orange-400: #ffa726;
      --paper-orange-500: #ff9800;
      --paper-orange-600: #fb8c00;
      --paper-orange-700: #f57c00;
      --paper-orange-800: #ef6c00;
      --paper-orange-900: #e65100;
      --paper-orange-a100: #ffd180;
      --paper-orange-a200: #ffab40;
      --paper-orange-a400: #ff9100;
      --paper-orange-a700: #ff6500;

      --paper-deep-orange-50: #fbe9e7;
      --paper-deep-orange-100: #ffccbc;
      --paper-deep-orange-200: #ffab91;
      --paper-deep-orange-300: #ff8a65;
      --paper-deep-orange-400: #ff7043;
      --paper-deep-orange-500: #ff5722;
      --paper-deep-orange-600: #f4511e;
      --paper-deep-orange-700: #e64a19;
      --paper-deep-orange-800: #d84315;
      --paper-deep-orange-900: #bf360c;
      --paper-deep-orange-a100: #ff9e80;
      --paper-deep-orange-a200: #ff6e40;
      --paper-deep-orange-a400: #ff3d00;
      --paper-deep-orange-a700: #dd2c00;

      --paper-brown-50: #efebe9;
      --paper-brown-100: #d7ccc8;
      --paper-brown-200: #bcaaa4;
      --paper-brown-300: #a1887f;
      --paper-brown-400: #8d6e63;
      --paper-brown-500: #795548;
      --paper-brown-600: #6d4c41;
      --paper-brown-700: #5d4037;
      --paper-brown-800: #4e342e;
      --paper-brown-900: #3e2723;

      --paper-grey-50: #fafafa;
      --paper-grey-100: #f5f5f5;
      --paper-grey-200: #eeeeee;
      --paper-grey-300: #e0e0e0;
      --paper-grey-400: #bdbdbd;
      --paper-grey-500: #9e9e9e;
      --paper-grey-600: #757575;
      --paper-grey-700: #616161;
      --paper-grey-800: #424242;
      --paper-grey-900: #212121;

      --paper-blue-grey-50: #eceff1;
      --paper-blue-grey-100: #cfd8dc;
      --paper-blue-grey-200: #b0bec5;
      --paper-blue-grey-300: #90a4ae;
      --paper-blue-grey-400: #78909c;
      --paper-blue-grey-500: #607d8b;
      --paper-blue-grey-600: #546e7a;
      --paper-blue-grey-700: #455a64;
      --paper-blue-grey-800: #37474f;
      --paper-blue-grey-900: #263238;

      
      --dark-divider-opacity: 0.12;
      --dark-disabled-opacity: 0.38; 
      --dark-secondary-opacity: 0.54;
      --dark-primary-opacity: 0.87;

      
      --light-divider-opacity: 0.12;
      --light-disabled-opacity: 0.3; 
      --light-secondary-opacity: 0.7;
      --light-primary-opacity: 1.0;
}

</style>
</custom-style><custom-style>
  <style is="custom-style">html {
  --primary-text-color: var(--light-theme-text-color);
      --primary-background-color: var(--light-theme-background-color);
      --secondary-text-color: var(--light-theme-secondary-color);
      --disabled-text-color: var(--light-theme-disabled-color);
      --divider-color: var(--light-theme-divider-color);
      --error-color: var(--paper-deep-orange-a700);

      
      --primary-color: var(--paper-indigo-500);
      --light-primary-color: var(--paper-indigo-100);
      --dark-primary-color: var(--paper-indigo-700);

      --accent-color: var(--paper-pink-a200);
      --light-accent-color: var(--paper-pink-a100);
      --dark-accent-color: var(--paper-pink-a400);


      
      --light-theme-background-color: #ffffff;
      --light-theme-base-color: #000000;
      --light-theme-text-color: var(--paper-grey-900);
      --light-theme-secondary-color: #737373;  
      --light-theme-disabled-color: #9b9b9b;  
      --light-theme-divider-color: #dbdbdb;

      
      --dark-theme-background-color: var(--paper-grey-900);
      --dark-theme-base-color: #ffffff;
      --dark-theme-text-color: #ffffff;
      --dark-theme-secondary-color: #bcbcbc;  
      --dark-theme-disabled-color: #646464;  
      --dark-theme-divider-color: #3c3c3c;

      
      --text-primary-color: var(--dark-theme-text-color);
      --default-primary-color: var(--primary-color);
}

</style>
</custom-style><script async="" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/lazy.min.js.download"></script><script src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/loader.js.download"></script>
<!--[if lt IE 9]>
<script src='http://html5shim.googlecode.com/svn/trunk/html5.js' type='text/javascript'></script>
<![endif]-->
<!--[endif]>  <![endif]-->
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "WebSite",
  "url": "https://www.qwiklabs.com/",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://www.qwiklabs.com/catalog?keywords={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
<script id="ze-snippet" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/snippet.js.download"></script>


<meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="Uz7pqf5S5F2yQZwuXgFH2WgtNOovdpFBSG5B12D+WOreuEzICTopbGP6U8FQrWYWugQekKAYS/SDqayalYymuA==">
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport">
<meta content="1rRsY0INj8RvwB5EF5pwdxt2A2P9aDgAlsICaJ0d5w0" name="google-site-verification">
<meta content="#3681E4" property="msapplication-TileColor">
<meta content="/favicon-144.png" property="msapplication-TileImage">
<meta content="[{&quot;id&quot;:&quot;recaptcha_experiment&quot;,&quot;optimize_id&quot;:&quot;dpViOcLkT3qS4TvL2mRojA&quot;,&quot;title&quot;:&quot;No Recaptcha shown for trusted users&quot;,&quot;variant_index&quot;:1,&quot;variant&quot;:&quot;no_recaptcha&quot;}]" name="active-experiments">
<meta content="{&quot;userId&quot;:5037645}" name="help-api-product-data">
<meta content="In this lab, you populate rentals data in Cloud SQL for the rentals recommendation engine to use. The recommendations engine itself will run on Dataproc using Spark ML." name="description">
<meta content="Qwiklabs" name="author">
<meta content="Recommending Products Using Cloud SQL and Spark | Qwiklabs" property="og:title">
<meta content="website" property="og:type">
<meta content="/favicon-144.png" property="og:image">
<meta content="Qwiklabs" property="og:site_name">
<meta content="In this lab, you populate rentals data in Cloud SQL for the rentals recommendation engine to use. The recommendations engine itself will run on Dataproc using Spark ML." property="og:description">
<meta content="/qwiklabs_logo_900x887.png" property="og:logo" size="900x887">
<meta content="/qwiklabs_logo_994x187.png" property="og:logo" size="994x187">


<link href="https://googlecoursera.qwiklabs.com/favicon-32.png" rel="shortcut icon">
<link color="#3681E4" href="https://googlecoursera.qwiklabs.com/favicon-svg.svg" rel="mask-icon">
<link href="https://googlecoursera.qwiklabs.com/favicon-180.png" rel="apple-touch-icon-precomposed">



<link rel="stylesheet" media="screen" href="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/css">


<link rel="stylesheet" media="all" href="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/application-fb473edc053b24560c69f1d5be0cd02986f15b92ec98669f3b5cf737362461cc.css">



</head>
<body class="lab-show l-full no-nav application-new focuses focuses-show lab-show l-full no-nav ">
<noscript>
<iframe height='0' src='https://www.googletagmanager.com/ns.html?id=GTM-TQR88QK' style='display:none;visibility:hidden;' width='0'></iframe>
</noscript>
<span class="hidden" id="flash-sibling-before"></span>

<div class="header-container">
<div class="header">
<ql-icon-button class="js-nav-toggle header__nav-panel-button l-mrm">menu</ql-icon-button>
<div class="header__title">
<ql-icon-button label="Back" href="https://www.coursera.org/" id="9fd1ac8bec4b7eaf" target="_self" tabindex="0">arrow_back</ql-icon-button><div class="mdl-tooltip" data-mdl-for="9fd1ac8bec4b7eaf" data-upgraded=",MaterialTooltip">Back</div>

<h1 class="headline-5">
Recommending Products Using Cloud SQL and Spark
</h1>
</div>
<div class="header__actions">
<ql-icon-button class="header__button--search js-header-search-bar-button">search</ql-icon-button>
<ql-icon-button id="control-panel-target" style="display: none;" aria-haspopup="true" aria-controls="control-panel-menu">
dashboard
</ql-icon-button>
<ql-menu for="control-panel-target" id="control-panel-menu" style="left: -1000px; top: -1000px; opacity: 0; visibility: hidden;" role="menu" aria-labelledby="control-panel-target"></ql-menu>

<ql-icon-button id="help-menu-button" aria-haspopup="true" aria-controls="help-menu" tabindex="0">help</ql-icon-button>
<div class="mdl-tooltip js-tooltip" data-mdl-for="help-menu-button" data-upgraded=",MaterialTooltip">
Help
</div>
<ql-menu for="help-menu-button" id="help-menu" style="left: -1000px; top: -1000px; opacity: 0; visibility: hidden;" role="menu" aria-labelledby="help-menu-button">
<ql-menu-item>
<ql-help context="lab" data-analytics-action="opened_help" data-analytics-label="lab" productdata="{&quot;userId&quot;:5037645}">
Help Center
</ql-help>
</ql-menu-item>
<ql-menu-item>
<a target="_blank" class="ql-body-1" href="https://support.google.com/qwiklabs/contact/contact_us" tabindex="-1" role="menuitem">Email support</a>
</ql-menu-item>
<ql-menu-item>
<a class="ql-body-1" onclick="ql.chat.open()" tabindex="-1" role="menuitem">Chat support</a>
</ql-menu-item>
</ql-menu>

<ql-icon-button id="language">language</ql-icon-button>
<div class="mdl-menu__container is-upgraded"><div class="mdl-menu__outline"></div><div class="mdl-menu mdl-menu__bottom-right mdl-js-menu elevation-3" for="language" data-upgraded=",MaterialMenu">
<a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ar" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=ar&amp;parent=lti_session" tabindex="-1">العربية‬‎
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="de" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=de&amp;parent=lti_session" tabindex="-1">Deutsch
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="en" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=en&amp;parent=lti_session" tabindex="-1">English
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="es" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=es&amp;parent=lti_session" tabindex="-1">español (Latinoamérica)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="fr" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=fr&amp;parent=lti_session" tabindex="-1">français
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="id" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=id&amp;parent=lti_session" tabindex="-1">bahasa Indonesia
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="it" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=it&amp;parent=lti_session" tabindex="-1">Italiano
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ja" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=ja&amp;parent=lti_session" tabindex="-1">日本語
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ko" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=ko&amp;parent=lti_session" tabindex="-1">한국어
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pl" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=pl&amp;parent=lti_session" tabindex="-1">Polski
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pt_BR" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=pt_BR&amp;parent=lti_session" tabindex="-1">português (Brasil)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="pt_PT" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=pt_PT&amp;parent=lti_session" tabindex="-1">português (Portugal)
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="ru" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=ru&amp;parent=lti_session" tabindex="-1">русский
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="tr" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=tr&amp;parent=lti_session" tabindex="-1">Türkçe
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="zh" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=zh&amp;parent=lti_session" tabindex="-1">简体中文
</a><a class="mdl-menu__item locale-link" data-analytics-action="changed_locale" data-analytics-label="zh_TW" href="https://googlecoursera.qwiklabs.com/focuses/16187025?locale=zh_TW&amp;parent=lti_session" tabindex="-1">繁體中文
</a></div></div>
<button aria-label="My Account menu button" class="icon-button" id="my_account" aria-haspopup="true" aria-controls="">
<ql-avatar></ql-avatar>
</button>
<ql-menu for="my_account" open="" style="left: -1000px; top: -1000px; opacity: 0; visibility: hidden;" role="menu" aria-labelledby="my_account">
<div class="my-account-menu">
<ql-avatar class="l-mtl l-mbl" size="120"></ql-avatar>
<div class="my-account-menu__user-info l-mbl">
<h4 class="ql-subhead-1">Bishnu Poudel</h4>
<p class="ql-body-2 text--light">replytobishnu@yahoo.com</p>
<p class="ql-body-2 text--light">
</p>
<a class="text--green ql-subhead-2" href="https://googlecoursera.qwiklabs.com/my_account/payments"><ql-chip positive="">
0 Credits
</ql-chip>
</a></div>
<div class="buttons l-mbl">
<a class="button button--hairline" id="settings" href="https://googlecoursera.qwiklabs.com/my_account/profile">Settings</a>
</div>
<hr>
<ql-button data-analytics-action="clicked_sign_out" href="/users/sign_out" method="delete">
Sign Out
</ql-button>
<div class="privacy l-mtl">
<a class="ql-caption text--light" href="https://googlecoursera.qwiklabs.com/privacy_policy">Privacy</a>
<span class="ql-caption text--light l-mls l-mrs">·</span>
<a class="ql-caption text--light" href="https://googlecoursera.qwiklabs.com/terms_of_service">Terms</a>
</div>
</div>
</ql-menu>

</div>
</div>
<div class="header__search-bar js-header-search-bar">
<form class="js-search-form-mobile" onsubmit="ql.searchFilter(); return false;" action="https://googlecoursera.qwiklabs.com/searches/elasticsearch" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="Uz7pqf5S5F2yQZwuXgFH2WgtNOovdpFBSG5B12D+WOreuEzICTopbGP6U8FQrWYWugQekKAYS/SDqayalYymuA==">
<input type="text" name="keywords" id="keywords" placeholder="Search" maxlength="255" aria-label="catalog search bar">
</form>

<ql-icon-button class="js-close-search-bar">close</ql-icon-button>
</div>
</div>

<nav class="nav-bar">
<a class="nav-bar__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/"><ql-icon class="nav-bar__item__icon">
home
</ql-icon>
<span class="nav-bar__item__label">
Home
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/catalog"><ql-icon class="nav-bar__item__icon">
school
</ql-icon>
<span class="nav-bar__item__label">
Catalog
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_learning"><ql-icon class="nav-bar__item__icon">
event_note
</ql-icon>
<span class="nav-bar__item__label">
My Learning
</span>
</a>
</nav>

<nav class="nav-panel js-nav-panel">
<div class="nav-panel__logo">
<div class="logo logo--blue"></div>
</div>
<a title="Home" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/"><ql-icon class="nav-panel__item__icon">
home
</ql-icon>
<div class="nav-panel__item__label">
Home
</div>
</a>
<a title="Catalog" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/catalog"><ql-icon class="nav-panel__item__icon">
school
</ql-icon>
<div class="nav-panel__item__label">
Catalog
</div>
</a>
<a title="My Learning" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_learning"><ql-icon class="nav-panel__item__icon">
event_note
</ql-icon>
<div class="nav-panel__item__label">
My Learning
</div>
</a>
<div class="nav-panel__spacer"></div>
<a title="Profile" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_account/profile"><ql-icon class="nav-panel__item__icon">
account_circle
</ql-icon>
<div class="nav-panel__item__label">
Profile
</div>
</a>
<a title="Credits &amp; Subscriptions" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_account/credits"><ql-icon class="nav-panel__item__icon">
money
</ql-icon>
<div class="nav-panel__item__label">
Credits &amp; Subscriptions
</div>
</a>
<a title="Security" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_account/security"><ql-icon class="nav-panel__item__icon">
security
</ql-icon>
<div class="nav-panel__item__label">
Security
</div>
</a>
<div class="nav-panel__spacer"></div>
<a class="nav-panel__item" tabindex="-1" href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#"><ql-help>
<div class="nav-panel__help-item">
<ql-icon class="nav-panel__item__icon">help</ql-icon>
<div class="nav-panel__item__label">
Help
</div>
</div>
</ql-help>
</a><div class="nav-panel__small-links">
<a tabindex="-1" href="https://googlecoursera.qwiklabs.com/privacy_policy">Privacy</a>
<a tabindex="-1" href="https://googlecoursera.qwiklabs.com/terms_of_service">Terms</a>
</div>
</nav>
<div class="nav-panel__overlay js-nav-toggle"></div>

<main class="js-main">
<div class="l-main-wrapper" id="main-wrapper">







<ql-drawer-container class="js-lab-state" data-analytics-payload="{&quot;label&quot;:&quot;Recommending Products Using Cloud SQL and Spark&quot;,&quot;lab_name&quot;:&quot;Recommending Products Using Cloud SQL and Spark&quot;,&quot;classroom_name&quot;:null,&quot;deployment&quot;:&quot;googlecoursera-run&quot;}" data-focus-id="16187025" data-lab-billing-limit="0.0" data-lab-duration="5400" data-parent="lti_session" data-recaptcha-enabled="" id="lab-container">
<ql-drawer id="terminal-drawer" slot="drawer" style="width: calc(100% - 480px)">
<iframe allow="clipboard-read" class="terminal" id="embedded-resource" __idm_frm__="610" data-gtm-yt-inspected-1_25="true" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/saved_resource(3).html"></iframe>
</ql-drawer>
<ql-drawer-content class="js-lab-wrapper" id="lab-content" slot="drawer-content">
<ql-drawer-container id="lab-content-container">
<ql-drawer id="control-panel-drawer" open="" slot="drawer" width="320" style="width: 320px;">
<ql-lab-control-panel class="ql-lab-control-panel__max-height control-panel js-lab-control-panel" connectionfiles="[]" labcontrolbutton="{&quot;disabled&quot;:false,&quot;pending&quot;:false,&quot;running&quot;:false}" labdetails="[]" labtimer="{&quot;ticking&quot;:false,&quot;secondsRemaining&quot;:5400}" studentresources="[]">
<script src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/api.js.download"></script>
        <script>
          // Define function so that we can call it again later if we need to reset it
          // This executes reCAPTCHA and then calls our callback.
          function executeRecaptchaForStartLab() {
            grecaptcha.ready(function() {
              grecaptcha.execute('6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr', {action: 'start_lab'}).then(function(token) {
                setInputWithRecaptchaResponseTokenForStartLab('g-recaptcha-response-data-start-lab', token)
              });
            });
          };
          // Invoke immediately
          executeRecaptchaForStartLab()

          // Async variant so you can await this function from another async function (no need for
          // an explicit callback function then!)
          // Returns a Promise that resolves with the response token.
          async function executeRecaptchaForStartLabAsync() {
            return new Promise((resolve, reject) => {
              grecaptcha.ready(async function() {
                resolve(await grecaptcha.execute('6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr', {action: 'start_lab'}))
              });
            })
          };

                    var setInputWithRecaptchaResponseTokenForStartLab = function(id, token) {
            var element = document.getElementById(id);
            element.value = token;
          }

        </script>
<input type="hidden" name="g-recaptcha-response-data[start_lab]" id="g-recaptcha-response-data-start-lab" data-sitekey="6LeVI8IUAAAAAJNdox5eTkYrw9SbvhZ1TFyv3iHr" class="g-recaptcha g-recaptcha-response " style="" value="03AGdBq25TQXw4J0WsWwzEWzv2J7h7MaqoCEfHjRWR0kVMok97lXAEVCDu5qMKeIE_Rv7LBL3nOldCNeQfCt-jEPT3bYY-j7PD_qymHDsIUUaWzOmXzza-bR5wczUHJqL8Pwofe_qUM8J1gN8e4Pfv0kPH43arYrlF94KE_qpgSoMFVUMf81FOA4hGZd3K-rSgGgOaq522BL8WzoDAhM138bH9vgIUKAVlIME3T2Imjfk3s_9HZ_XsPnRBHKa9A37e7NqAsHGqSJIa-SJhCkMiKLQfxpeGKL_e1BOaqPcLDCri-kOXPiiFxJoAALS02slT29VhB2XO2_dZdvi5WXGdg7xmoiIqLqU2b0FZ5dzBdovpgFk3LdlKZrB1eUbA62lxO-jX6TZCw0hnK2Bv5hnnBObz3DmfoWW7Pqu1QeDcx9AIGD0XyIFQpESEyUbi34i1Jiy7vvABhtWNfnKfDUqZuq21cxZ3pFtIKZlCMbFQy-aKylBAARnNOFgvc1hyM0DkGuEBHDWKdq9pRMTsHzQdU3AizRt9Ymr_9g1IMkjAUyJ0ylEQuzUew3wa2-wVZXlEzJi8UcmG_BIu7RRA04fYdDNGVP6KWEHL1WrYiMKp2vigbrItml2tphGNe-klCZFnzZ40aynBQCf2hn_GlqdkSfo52ZqgyXyJZ1vyFqfcz-LGBF77qALnwiWRfZ7dPUT26seZslhx5Ir_48oXPepWAZOBH09Ql_KxuE3-2yCQGSgBRn3MK9k25_Oazuy96rie-mVtwk1EchhAameSxdA8U5ozubo6avDXmq6ITQ9qQoHZhsu4hRUeTGxB60hbgDbh6c-cfbJaxeOUixROZhuPSZUB9GSKNlYlp-cP3sF1VnAi7ZEOH8z2Z8tyM0u3pBimftYwDL4IZdO99pUJbEyPZMPjMavbh2YnTa5bn2y_0fvxE0vevykuhDTRPgQ09TpIehFaFS9HN1ZBb6xs2g2aMY3H2E4qDPfjlxU46I1SAc1KoWdjleUC0-DB_B_pPXxaRfTIzPouCKZQ3xLRTm0sQVDiTOMA5vIVkkE_zMxpSU9MAKVqHs0ZEpXQNxUS7mSn8gypd7ely7qKf3Ax5LrrxDY0AS1FJ3s-5bS24_Pt1OR_m-PUa9agQgk6_Jxh5fMocoUAIsXT7ZmFyPpp4bvIRuxW_CJ228msug"><div style="width: 304px; height: 78px;"><div><iframe title="reCAPTCHA" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/anchor.html" width="304" height="78" role="presentation" name="a-h9tiluadkkid" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox" data-gtm-yt-inspected-1_25="true"></iframe></div><textarea id="g-recaptcha-response" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div></input>

<div class="hidden" id="recaptcha-v2-start-lab" slot="recaptcha">
<script src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/api.js(1).download" async="" defer=""></script>
<div data-sitekey="6LeOI8IUAAAAAPkHlMAE9NReCD_1WD81iYlBlCnV" data-callback="recaptchaComplete" data-expired-callback="expireV2Token" class="g-recaptcha "><div style="width: 304px; height: 78px;"><div><iframe title="reCAPTCHA" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/anchor(1).html" width="304" height="78" role="presentation" name="a-ecvswh7u8y4h" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox" data-gtm-yt-inspected-1_25="true"></iframe></div><textarea id="g-recaptcha-response-1" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe data-gtm-yt-inspected-1_25="true" __idm_frm__="624" style="display: none;" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/saved_resource(4).html"></iframe></div>
          <noscript>
            <div>
              <div style="width: 302px; height: 422px; position: relative;">
                <div style="width: 302px; height: 422px; position: absolute;">
                  <iframe
                    src="https://www.recaptcha.net/recaptcha/api/fallback?k=6LeOI8IUAAAAAPkHlMAE9NReCD_1WD81iYlBlCnV"
                    name="ReCAPTCHA"
                    style="width: 302px; height: 422px; border-style: none; border: 0; overflow: hidden;">
                  </iframe>
                </div>
              </div>
              <div style="width: 300px; height: 60px; border-style: none;
                bottom: 12px; left: 25px; margin: 0px; padding: 0px; right: 25px;
                background: #f9f9f9; border: 1px solid #c1c1c1; border-radius: 3px;">
                <textarea id="g-recaptcha-response" name="g-recaptcha-response"
                  class="g-recaptcha-response"
                  style="width: 250px; height: 40px; border: 1px solid #c1c1c1;
                  margin: 10px 25px; padding: 0px; resize: none;">
                </textarea>
              </div>
            </div>
          </noscript>

</div>
</ql-lab-control-panel>
</ql-drawer>
<ql-drawer-content id="lab-instructions" slot="drawer-content">
<div class="alert alert--fake js-alert">
<p class="alert__message js-alert-message"></p>
<a class="alert__close js-alert-close">
<i class="fa fa-times"></i>
</a>
<iframe class="l-ie-iframe-fix" __idm_frm__="611" data-gtm-yt-inspected-1_25="true" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/saved_resource(5).html"></iframe>
</div>
<div class="js-lab-content lab-content__renderable-instructions">
<div class="lab-preamble">
<h1 class="lab-preamble__title">
Recommending Products Using Cloud SQL and Spark
</h1>
<div class="lab-preamble__details subtitle-headline-1">
<span>1 hour 30 minutes</span>
<span>Free</span>
<div class="lab__rating">
<a href="https://googlecoursera.qwiklabs.com/focuses/16187025/reviews?parent=lti_session"><div class="rateit" data-rateit-readonly="true" data-rateit-value="4.2909"><div class="rateit-reset" style="display: none;"></div><div class="rateit-range" style="width: 80px; height: 16px;"><div class="rateit-selected" style="height: 16px; width: 68.6544px;"></div><div class="rateit-hover" style="height:16px"></div></div></div>

</a><a data-target="#lab-review-modal" data-toggle="modal">
Rate Lab
</a>
</div>
</div>
</div>

<div class="js-markdown-instructions markdown-lab-instructions" id="markdown-lab-instructions">



<h2 id="step1">Overview</h2>
<p>In this lab, you populate rentals data in Cloud SQL for the rentals recommendation engine to use. The recommendations engine itself will run on Dataproc using Spark ML.</p>
<h3>Objectives</h3>
<p>In this lab, you learn how to perform the following tasks:</p>
<ul>
<li>
<p>Create a Cloud SQL instance</p>
</li>
<li>
<p>Create database tables by importing .sql files from Cloud Storage</p>
</li>
<li>
<p>Populate the tables by importing .csv files from Cloud Storage</p>
</li>
<li>
<p>Allow access to Cloud SQL</p>
</li>
<li>
<p>Explore the rentals data using SQL statements from Cloud Shell</p>
</li>
</ul>
<h2 id="step2">Set up your environments</h2>
<h3>Qwiklabs setup</h3>
<p>For each lab, you get a new GCP project and set of resources for a fixed time at no cost.</p>
<ol>
<li>
<p>Make sure you signed into Qwiklabs using an <strong>incognito window</strong>.</p>
</li>
<li>
<p>Note the lab's access time (for example, <img alt="img/time.png" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/aZQJ4BT7uCmM9XR6BTXgTRP1Hfu1T7q6V+cnbdEsbpU="> and make sure you can finish in that time block.</p>
</li>
</ol>
<aside> <p>
  There is no pause feature. You can restart if needed, but you have to start at the beginning.
  </p>

</aside>
<ol start="3">
<li>
<p>When ready, click <img alt="img/start_lab.png" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/XE8x7uvQokyubNwnYKKc+vBBNrMlo5iNZiDDzQQ3Ddo=">.</p>
</li>
<li>
<p>Note your lab credentials. You will use them to sign in to Cloud Platform Console.
<img alt="img/open_google_console.png" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/0d78dhX6IVMVWmixCPPSBbmi5O2GPokCXf1Ps1AkTgI="></p>
</li>
<li>
<p>Click <strong>Open Google Console</strong>.</p>
</li>
<li>
<p>Click <strong>Use another account</strong> and copy/paste credentials for <strong>this</strong> lab into the prompts.</p>
</li>
</ol>
<aside class="warning"><p>
  If you use other credentials, you'll get errors or <strong>incur charges</strong>.
  </p>
</aside>
<ol start="7">
<li>Accept the terms and skip the recovery resource page.</li>
</ol>
<aside class="warning"><p>
  Do not click <strong>End Lab</strong> unless you are finished with the lab or want to restart it. This clears your work and removes the project.
  </p>
</aside>

<h3>Check project permissions</h3>
<p>Before you begin your work on Google Cloud, you need to ensure that your project has the correct permissions within Identity and Access Management (IAM).</p>
<ol>
<li>
<p>In the Google Cloud console, on the <strong>Navigation menu</strong> (<img alt="nav-menu.png" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/ITyhQn00xPCVZIksELAC4wax+QdPdrH2DNGLazXJKgw=">), click <strong>IAM &amp; Admin</strong> &gt; <strong>IAM</strong>.</p>
</li>
<li>
<p>Confirm that the default compute Service Account <code>{project-number}-compute@developer.gserviceaccount.com</code> is present and has the <code>editor</code> role assigned. The account prefix is the project number, which you can find on <strong>Navigation menu</strong> &gt; <strong>Home</strong>.</p>
</li>
</ol>
<p><img alt="check-sa.png" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/PaSJwLiQ6db41cptCuYECEHZtayQHGZpUJaR0fLIqTw="></p>
<p>If the account is not present in IAM or does not have the <code>editor</code> role, follow the steps below to assign the required role.</p>
<ul>
<li>
<p>In the Google Cloud console, on the <strong>Navigation menu</strong>, click <strong>Home</strong>.</p>
</li>
<li>
<p>Copy the project number (e.g. <code>729328892908</code>).</p>
</li>
<li>
<p>On the <strong>Navigation menu</strong>, click <strong>IAM &amp; Admin</strong> &gt; <strong>IAM</strong>.</p>
</li>
<li>
<p>At the top of the <strong>IAM</strong> page, click <strong>Add</strong>.</p>
</li>
<li>
<p>For <strong>New members</strong>, type:</p>
</li>
</ul>
<pre><code>{project-number}-compute@developer.gserviceaccount.com
</code><button class="button button--text button--small copy-button js-copy-button-0"><ql-icon>content_copy</ql-icon></button></pre>
<p>Replace <code>{project-number}</code> with your project number.</p>
<ul>
<li>For <strong>Role</strong>, select <strong>Project</strong> &gt; <strong>Editor</strong>. Click <strong>Save</strong>.</li>
</ul>
<p><img alt="add-sa.png" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/TJdJBvKxMtTArw6djkzJinwSxZq+Ya7fwXf54ROeHUM="></p>

<h2 id="step3">Task 1. Create a Cloud SQL instance</h2>
<ol>
<li>
<p>In the Google Cloud Console, Select <strong>Navigation menu &gt; SQL</strong> (in the Storage section).</p>
</li>
<li>
<p>Click  <strong>Create instance</strong>.</p>
</li>
<li>
<p>Click <strong>Choose MySQL</strong>.</p>
</li>
<li>
<p>For <strong>Instance ID</strong>, type <strong>rentals</strong>.</p>
<p><img alt="ab1cdf08212ecadf.png" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/4enBBCqiOP_MoylbsMJSGz_ddg+mLbJ1r7xOyokmf6Y="></p>
</li>
<li>
<p>Scroll down and specify a <strong>Root password</strong>. Before you forget, note down the root password.</p>
</li>
<li>
<p>For <strong>Region</strong> select <strong>us-central1</strong>.</p>
</li>
<li>
<p>Click <strong>Create instance</strong> to create the instance. It will take a minute or so for your Cloud SQL instance to be provisioned.</p>
</li>
</ol>
<h2 id="step4">Task 2. Create tables</h2>
<ol>
<li>
<p>While you wait for your instance to be created, read the below mySQL script and answer the questions that follow.</p>
</li>
</ol>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="pln">CREATE DATABASE IF NOT EXISTS recommendation_spark</span><span class="pun">;</span><span class="pln">

USE recommendation_spark</span><span class="pun">;</span><span class="pln">

DROP TABLE IF EXISTS </span><span class="typ">Recommendation</span><span class="pun">;</span><span class="pln">
DROP TABLE IF EXISTS </span><span class="typ">Rating</span><span class="pun">;</span><span class="pln">
DROP TABLE IF EXISTS </span><span class="typ">Accommodation</span><span class="pun">;</span><span class="pln">

CREATE TABLE IF NOT EXISTS </span><span class="typ">Accommodation</span><span class="pln">
</span><span class="pun">(</span><span class="pln">
  id varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  title varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  location varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  price </span><span class="kwd">int</span><span class="pun">,</span><span class="pln">
  rooms </span><span class="kwd">int</span><span class="pun">,</span><span class="pln">
  rating </span><span class="kwd">float</span><span class="pun">,</span><span class="pln">
  type varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  PRIMARY KEY </span><span class="pun">(</span><span class="pln">ID</span><span class="pun">)</span><span class="pln">
</span><span class="pun">);</span><span class="pln">

CREATE TABLE  IF NOT EXISTS </span><span class="typ">Rating</span><span class="pln">
</span><span class="pun">(</span><span class="pln">
  userId varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  accoId varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  rating </span><span class="kwd">int</span><span class="pun">,</span><span class="pln">
  PRIMARY KEY</span><span class="pun">(</span><span class="pln">accoId</span><span class="pun">,</span><span class="pln"> userId</span><span class="pun">),</span><span class="pln">
  FOREIGN KEY </span><span class="pun">(</span><span class="pln">accoId</span><span class="pun">)</span><span class="pln">
    REFERENCES </span><span class="typ">Accommodation</span><span class="pun">(</span><span class="pln">id</span><span class="pun">)</span><span class="pln">
</span><span class="pun">);</span><span class="pln">

CREATE TABLE  IF NOT EXISTS </span><span class="typ">Recommendation</span><span class="pln">
</span><span class="pun">(</span><span class="pln">
  userId varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  accoId varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  prediction </span><span class="kwd">float</span><span class="pun">,</span><span class="pln">
  PRIMARY KEY</span><span class="pun">(</span><span class="pln">userId</span><span class="pun">,</span><span class="pln"> accoId</span><span class="pun">),</span><span class="pln">
  FOREIGN KEY </span><span class="pun">(</span><span class="pln">accoId</span><span class="pun">)</span><span class="pln">
    REFERENCES </span><span class="typ">Accommodation</span><span class="pun">(</span><span class="pln">id</span><span class="pun">)</span><span class="pln">
</span><span class="pun">);</span><span class="pln">

SHOW DATABASES</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-1"><ql-icon>content_copy</ql-icon></button></pre>
<p><ql-multiple-choice-probe answerindex="0" optiontitles="[
&quot;3&quot;,
&quot;2&quot;,
&quot;1&quot;                      
]" shuffle="" stem="How many tables will this script create?">
</ql-multiple-choice-probe></p>
<p><ql-multiple-choice-probe answerindex="1" optiontitles="[
&quot;Recommendation&quot;,
&quot;Rating&quot;,
&quot;Accommodation&quot;                      
]" stem="When a user rates a house (giving it four stars for example), an entry is added to the _______ table.">
</ql-multiple-choice-probe></p>
<p><ql-multiple-choice-probe answerindex="2" optiontitles="[
&quot;Recommendation&quot;,
&quot;Rating&quot;,
&quot;Accommodation&quot;                      
]" stem="General information about houses, such as the number of rooms they have and their average rating is stored in the _________ table.">
</ql-multiple-choice-probe></p>
<p><ql-multiple-choice-probe answerindex="0" optiontitles="[
&quot;Recommendation&quot;,
&quot;Rating&quot;,
&quot;Accommodation&quot;                      
]" stem="The job of the recommendation engine is to fill out the ___________ table for each user and house: this is the predicted rating of that house by that user.">
</ql-multiple-choice-probe></p>
<ol start="2">
<li>
<p>In <strong>Cloud SQL</strong>, click <strong>rentals</strong> to view instance information.</p>
</li>
</ol>
<h3>Connect to the database</h3>
<ol>
<li>Find the <strong>Connect to this instance</strong> box on the page and click on <strong>connect using Cloud Shell</strong>.</li>
</ol>
<ql-infobox><strong>Note:</strong> You could also connect to your instance from a dedicated Cloud Compute Engine VM but for now you'll have Cloud Shell create a micro-VM for you and operate from there.</ql-infobox>
<ol start="2">
<li>
<p>If required, click <strong>Continue</strong>. Wait for Cloud Shell to load.</p>
</li>
<li>
<p>Once Cloud Shell loads, you will see the below command already typed:</p>
</li>
</ol>
<ul>
<li>
<p><code>gcloud sql connect rentals --user=root --quiet</code></p>
</li>
</ul>
<ol start="4">
<li>
<p>Press <strong>ENTER</strong>.</p>
</li>
<li>
<p>Wait for your IP Address to be whitelisted.</p>
</li>
</ol>
<pre><code>Allowlisting your IP for incoming connection for 5 minutes...⠹
</code><button class="button button--text button--small copy-button js-copy-button-2"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="6">
<li>When prompted, enter your password and press <strong>ENTER</strong> (note: you will not see your password typed in or even ****).</li>
</ol>
<p>You can now run commands against your database!
<img alt="mysql-connection.png" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/9w6LTrHn0vWVgSiXjs166kSpFDAKhCkpf4Tct48Yy8w="></p>
<ol start="7">
<li>Run the following command:</li>
</ol>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">SHOW DATABASES</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-3"><ql-icon>content_copy</ql-icon></button></pre>
<p>You should see the default system databases:</p>
<pre><code>+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
</code><button class="button button--text button--small copy-button js-copy-button-4"><ql-icon>content_copy</ql-icon></button></pre>
<ql-infobox><strong>Note:</strong> You must always end your mySQL commands with a semi-colon `;`</ql-infobox>
<ol start="8">
<li>
<p>Copy and paste the below SQL statement you analyzed earlier into the command line.</p>
</li>
</ol>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="pln">CREATE DATABASE IF NOT EXISTS recommendation_spark</span><span class="pun">;</span><span class="pln">

USE recommendation_spark</span><span class="pun">;</span><span class="pln">

DROP TABLE IF EXISTS </span><span class="typ">Recommendation</span><span class="pun">;</span><span class="pln">
DROP TABLE IF EXISTS </span><span class="typ">Rating</span><span class="pun">;</span><span class="pln">
DROP TABLE IF EXISTS </span><span class="typ">Accommodation</span><span class="pun">;</span><span class="pln">

CREATE TABLE IF NOT EXISTS </span><span class="typ">Accommodation</span><span class="pln">
</span><span class="pun">(</span><span class="pln">
  id varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  title varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  location varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  price </span><span class="kwd">int</span><span class="pun">,</span><span class="pln">
  rooms </span><span class="kwd">int</span><span class="pun">,</span><span class="pln">
  rating </span><span class="kwd">float</span><span class="pun">,</span><span class="pln">
  type varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  PRIMARY KEY </span><span class="pun">(</span><span class="pln">ID</span><span class="pun">)</span><span class="pln">
</span><span class="pun">);</span><span class="pln">

CREATE TABLE  IF NOT EXISTS </span><span class="typ">Rating</span><span class="pln">
</span><span class="pun">(</span><span class="pln">
  userId varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  accoId varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  rating </span><span class="kwd">int</span><span class="pun">,</span><span class="pln">
  PRIMARY KEY</span><span class="pun">(</span><span class="pln">accoId</span><span class="pun">,</span><span class="pln"> userId</span><span class="pun">),</span><span class="pln">
  FOREIGN KEY </span><span class="pun">(</span><span class="pln">accoId</span><span class="pun">)</span><span class="pln">
    REFERENCES </span><span class="typ">Accommodation</span><span class="pun">(</span><span class="pln">id</span><span class="pun">)</span><span class="pln">
</span><span class="pun">);</span><span class="pln">

CREATE TABLE  IF NOT EXISTS </span><span class="typ">Recommendation</span><span class="pln">
</span><span class="pun">(</span><span class="pln">
  userId varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  accoId varchar</span><span class="pun">(</span><span class="lit">255</span><span class="pun">),</span><span class="pln">
  prediction </span><span class="kwd">float</span><span class="pun">,</span><span class="pln">
  PRIMARY KEY</span><span class="pun">(</span><span class="pln">userId</span><span class="pun">,</span><span class="pln"> accoId</span><span class="pun">),</span><span class="pln">
  FOREIGN KEY </span><span class="pun">(</span><span class="pln">accoId</span><span class="pun">)</span><span class="pln">
    REFERENCES </span><span class="typ">Accommodation</span><span class="pun">(</span><span class="pln">id</span><span class="pun">)</span><span class="pln">
</span><span class="pun">);</span><span class="pln">

SHOW DATABASES</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-5"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="9">
<li>
<p>Press <strong>ENTER</strong>.</p>
</li>
<li>
<p>Confirm that you now see <code>recommendation_spark</code> as a database:</p>
</li>
</ol>
<pre><code>+----------------------+
| Database             |
+----------------------+
| information_schema   |
| mysql                |
| performance_schema   |
| recommendation_spark |
| sys                  |
+----------------------+
</code><button class="button button--text button--small copy-button js-copy-button-6"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="11">
<li>
<p>Run the following command to show the tables:</p>
</li>
</ol>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="pln">USE recommendation_spark</span><span class="pun">;</span><span class="pln">

SHOW TABLES</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-7"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="12">
<li>
<p>Press <strong>ENTER</strong>.</p>
</li>
<li>
<p>Confirm that you see the three tables:</p>
</li>
</ol>
<pre><code>+--------------------------------+
| Tables_in_recommendation_spark |
+--------------------------------+
| Accommodation                  |
| Rating                         |
| Recommendation                 |
+--------------------------------+
</code><button class="button button--text button--small copy-button js-copy-button-8"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="14">
<li>Run the following query:</li>
</ol>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="pln">SELECT </span><span class="pun">*</span><span class="pln"> FROM </span><span class="typ">Accommodation</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-9"><ql-icon>content_copy</ql-icon></button></pre>
<p><ql-multiple-choice-probe answerindex="0" optiontitles="[
&quot;Empty set (0)&quot;,
&quot;100&quot;,
&quot;1,000&quot;                      
]" stem="How many rows are in the Accommodation table?">
</ql-multiple-choice-probe></p>
<h2 id="step5">Task 3. Stage data in Cloud Storage</h2>
<h3>Option 1: Use the command line</h3>
<ol>
<li>
<p>Open a new Cloud Shell tab <strong>(do not use your existing mySQL Cloud Shell tab)</strong>.</p>
</li>
<li>
<p>Copy and paste the following command:</p>
</li>
</ol>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">echo </span><span class="str">"Creating bucket: gs://$DEVSHELL_PROJECT_ID"</span><span class="pln">
gsutil mb gs</span><span class="pun">://</span><span class="pln">$DEVSHELL_PROJECT_ID

echo </span><span class="str">"Copying data to our storage from public dataset"</span><span class="pln">
gsutil cp gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">training</span><span class="pun">/</span><span class="pln">bdml</span><span class="pun">/</span><span class="pln">v2</span><span class="pun">.</span><span class="lit">0</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="pln">accommodation</span><span class="pun">.</span><span class="pln">csv gs</span><span class="pun">://</span><span class="pln">$DEVSHELL_PROJECT_ID
gsutil cp gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">training</span><span class="pun">/</span><span class="pln">bdml</span><span class="pun">/</span><span class="pln">v2</span><span class="pun">.</span><span class="lit">0</span><span class="pun">/</span><span class="pln">data</span><span class="pun">/</span><span class="pln">rating</span><span class="pun">.</span><span class="pln">csv gs</span><span class="pun">://</span><span class="pln">$DEVSHELL_PROJECT_ID

echo </span><span class="str">"Show the files in our bucket"</span><span class="pln">
gsutil ls gs</span><span class="pun">://</span><span class="pln">$DEVSHELL_PROJECT_ID

echo </span><span class="str">"View some sample data"</span><span class="pln">
gsutil cat gs</span><span class="pun">://</span><span class="pln">$DEVSHELL_PROJECT_ID</span><span class="pun">/</span><span class="pln">accommodation</span><span class="pun">.</span><span class="pln">csv</span></code><button class="button button--text button--small copy-button js-copy-button-10"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="3">
<li>
<p>Press <strong>ENTER</strong>.</p>
</li>
</ol>
<h3>Option 2: Use the Cloud Console UI</h3>
<p><em>Skip these steps if you have already loaded your data using the command line.</em></p>
<ol>
<li>
<p>Navigate to <strong>Storage</strong> and select <strong>Cloud Storage &gt; Browser</strong>.</p>
</li>
<li>
<p>Click <strong>Create Bucket</strong> (if one does not already exist).</p>
</li>
<li>
<p>Specify your project name as the bucket name.</p>
</li>
<li>
<p>Click <strong>Create</strong>.</p>
</li>
<li>
<p>Download the below files locally and then upload them inside of your new bucket:</p>
</li>
</ol>
<ul>
<li>
<p><a href="https://storage.googleapis.com/cloud-training/bdml/v2.0/data/accommodation.csv" target="\_blank">accommodation.csv</a></p>
</li>
<li>
<p><a href="https://storage.googleapis.com/cloud-training/bdml/v2.0/data/rating.csv" target="\_blank">rating.csv</a></p>
</li>
</ul>
<h2 id="step6">Task 4. Load data from Cloud Storage into Cloud SQL tables</h2>
<ol>
<li>
<p>Navigate back to <strong>SQL</strong>.</p>
</li>
<li>
<p>Click on <strong>rentals</strong>.</p>
</li>
</ol>
<h3>Import accommodation data</h3>
<ol>
<li>
<p>Click <strong>Import</strong> (top menu).</p>
</li>
<li>
<p>Specify the following:</p>
</li>
</ol>
<ul>
<li>
<p>Source: Click <strong>Browse &gt; [Your-Bucket-Name] &gt; accommodation.csv</strong></p>
<p>Click <strong>Select</strong>.</p>
</li>
<li>
<p>Format of import: <strong>CSV</strong></p>
</li>
<li>
<p>Database: select <code>recommendation_spark</code> from the dropdown list</p>
</li>
<li>
<p>Table: copy and paste: <code>Accommodation</code></p>
</li>
</ul>
<ol start="3">
<li>Click <strong>Import</strong>.</li>
</ol>
<p><img alt="importdata" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/3wQKVM1HtbxupJQkgHeOCMDdJ8vye5Bl6GRiZS4IKGY="></p>
<ol start="4">
<li>
<p>You will be redirected back to the Overview page. Wait one minute for the data to load.</p>
</li>
</ol>
<h3>Import user rating data</h3>
<ol>
<li>
<p>Click <strong>Import</strong> (top menu).</p>
</li>
<li>
<p>Specify the following:</p>
</li>
</ol>
<ul>
<li>
<p>Source: Click <strong>Browse &gt; [Your-Bucket-Name] &gt; rating.csv</strong></p>
<p>Click <strong>Select</strong>.</p>
</li>
<li>
<p>Format of import: <strong>CSV</strong></p>
</li>
<li>
<p>Database: select <code>recommendation_spark</code> from the dropdown list</p>
</li>
<li>
<p>Table: copy and paste: <code>Rating</code></p>
</li>
</ul>
<ol start="3">
<li>
<p>Click <strong>Import</strong>.</p>
</li>
<li>
<p>You will be redirected back to the Overview page. Wait one minute for the data to load.</p>
</li>
</ol>

<h2 id="step7">Task 5. Explore Cloud SQL data</h2>
<ol>
<li>
<p>If you closed your Cloud Shell connection to mySQL, open it again by finding <strong>Connect to this instance</strong> and clicking <strong>Connect using Cloud Shell</strong>.</p>
</li>
<li>
<p>Press <strong>ENTER</strong> when prompted to log in.</p>
</li>
<li>
<p>Provide your password and press <strong>ENTER</strong>.</p>
</li>
<li>
<p>Query the ratings data:</p>
</li>
</ol>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="pln">USE recommendation_spark</span><span class="pun">;</span><span class="pln">

SELECT </span><span class="pun">*</span><span class="pln"> FROM </span><span class="typ">Rating</span><span class="pln">
LIMIT </span><span class="lit">15</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-11"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="5">
<li>Use a SQL aggregation function to count the number of rows in the table.</li>
</ol>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="pln">SELECT COUNT</span><span class="pun">(*)</span><span class="pln"> AS num_ratings
FROM </span><span class="typ">Rating</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-12"><ql-icon>content_copy</ql-icon></button></pre>
<p><ql-multiple-choice-probe answerindex="0" optiontitles="[
&quot;1186&quot;,
&quot;100,000&quot;,
&quot;5,203&quot;                      
]" stem="How many ratings are in the table?">
</ql-multiple-choice-probe></p>
<ol start="6">
<li>What is the average review rating of accommodations?</li>
</ol>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="pln">SELECT
    COUNT</span><span class="pun">(</span><span class="pln">userId</span><span class="pun">)</span><span class="pln"> AS num_ratings</span><span class="pun">,</span><span class="pln">
    COUNT</span><span class="pun">(</span><span class="pln">DISTINCT userId</span><span class="pun">)</span><span class="pln"> AS distinct_user_ratings</span><span class="pun">,</span><span class="pln">
    MIN</span><span class="pun">(</span><span class="pln">rating</span><span class="pun">)</span><span class="pln"> AS worst_rating</span><span class="pun">,</span><span class="pln">
    MAX</span><span class="pun">(</span><span class="pln">rating</span><span class="pun">)</span><span class="pln"> AS best_rating</span><span class="pun">,</span><span class="pln">
    AVG</span><span class="pun">(</span><span class="pln">rating</span><span class="pun">)</span><span class="pln"> AS avg_rating
FROM </span><span class="typ">Rating</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-13"><ql-icon>content_copy</ql-icon></button></pre>
<p><ql-multiple-choice-probe answerindex="0" optiontitles="[
&quot;2.46&quot;,
&quot;4.51&quot;,
&quot;5.0&quot;                      
]" shuffle="" stem="What is the average rating across all reviews?">
</ql-multiple-choice-probe></p>
<p><ql-multiple-choice-probe answerindex="0" optiontitles="[
&quot;There are 25 unique users who provided the ratings&quot;,
&quot;There are 25 ratings per user&quot;,
&quot;There are 25 ratings per accommodation&quot;                      
]" shuffle="" stem="What does the 25 for distinct_user_ratings mean?">
</ql-multiple-choice-probe></p>
<p>In machine learning, you will need a rich history of user preferences for the model to learn from. Run the below query to see which users have provided the most ratings.</p>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="pln">SELECT
    userId</span><span class="pun">,</span><span class="pln">
    COUNT</span><span class="pun">(</span><span class="pln">rating</span><span class="pun">)</span><span class="pln"> AS num_ratings
FROM </span><span class="typ">Rating</span><span class="pln">
GROUP BY userId
ORDER BY num_ratings DESC</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-14"><ql-icon>content_copy</ql-icon></button></pre>
<p><ql-multiple-choice-probe answerindex="0" optiontitles="[
&quot;75&quot;,
&quot;100&quot;,
&quot;50&quot;                      
]" shuffle="" stem="How many reviews did the top user leave?">
</ql-multiple-choice-probe></p>
<ol start="7">
<li>
<p>Exit the mysql prompt by typing <strong>exit</strong>.</p>
</li>
</ol>
<h2 id="step8">Task 6. Launch Dataproc</h2>
<p>You use Dataproc to train the recommendations machine learning model based on users' previous ratings. You then apply that model to create a list of recommendations for every user in the database</p>
<p>To launch Dataproc and configure it so that each of the machines in the cluster can access Cloud SQL:</p>
<ol>
<li>
<p>In the Cloud Console, on the <strong>Navigation menu</strong> (<img alt="Navigation menu" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/tkgw1TDgj4Q+YKQUW4jUFd0O5OEKlUMBRYbhlCrF0WY=" title="Navigation menu">), click <strong>SQL</strong> and note the region of your Cloud SQL instance:</p>
<p><img alt="fc8f254ae64a75b4.png" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/rruQxE8GWYDTbXn5pREQ02XbkgvaVI4j9_VjjQj7Suk="></p>
<p>In the snapshot above, the region is <code>us-central1</code> and zone is <code>us-central1-c</code>.</p>
</li>
<li>
<p>In the Cloud Console, on the <strong>Navigation menu</strong> (<img alt="Navigation menu" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/tkgw1TDgj4Q+YKQUW4jUFd0O5OEKlUMBRYbhlCrF0WY=" title="Navigation menu">), click <strong>Dataproc</strong> and click <strong>Enable API</strong> if prompted.</p>
</li>
<li>
<p>Once enabled, click <strong>Create cluster</strong> and name your cluster <strong>rentals</strong>.</p>
</li>
<li>
<p>Leave the <strong>Region</strong> as it is i.e. <strong>us-central1</strong> and change the <strong>Zone</strong> to <strong>us-central1-c</strong> (in the same zone as your Cloud SQL instance). This will minimize network latency between the cluster and the database.</p>
</li>
<li>
<p>Click on <strong>Configure nodes</strong>.</p>
</li>
<li>
<p>For <strong>Master node</strong>, for <strong>Machine type</strong>, select <strong>n1-standard-2 (2 vCPUs, 7.5 GB memory)</strong>.</p>
</li>
<li>
<p>For <strong>Worker nodes</strong>, for <strong>Machine type</strong>, select <strong>n1-standard-2 (2 vCPUs, 7.5 GB memory)</strong>.</p>
</li>
<li>
<p>Leave all other values with their default and click <strong>Create</strong>.  It will take 1-3 minutes to provision your cluster.</p>
</li>
<li>
<p>Note the <strong>Name</strong>, <strong>Zone</strong> and <strong>Total worker nodes</strong> in your cluster.</p>
</li>
<li>
<p>Copy and paste the below bash script into your Cloud Shell (optionally change <strong>CLUSTER, ZONE, NWORKERS</strong> if necessary before running)</p>
</li>
</ol>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">echo </span><span class="str">"Authorizing Cloud Dataproc to connect with Cloud SQL"</span><span class="pln">
CLUSTER</span><span class="pun">=</span><span class="pln">rentals
CLOUDSQL</span><span class="pun">=</span><span class="pln">rentals
ZONE</span><span class="pun">=</span><span class="pln">us</span><span class="pun">-</span><span class="pln">central1</span><span class="pun">-</span><span class="pln">c
NWORKERS</span><span class="pun">=</span><span class="lit">2</span><span class="pln">

machines</span><span class="pun">=</span><span class="str">"$CLUSTER-m"</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> w </span><span class="kwd">in</span><span class="pln"> </span><span class="str">`seq 0 $(($NWORKERS - 1))`</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
   machines</span><span class="pun">=</span><span class="str">"$machines $CLUSTER-w-$w"</span><span class="pln">
</span><span class="kwd">done</span><span class="pln">

echo </span><span class="str">"Machines to authorize: $machines in $ZONE ... finding their IP addresses"</span><span class="pln">
ips</span><span class="pun">=</span><span class="str">""</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> machine </span><span class="kwd">in</span><span class="pln"> $machines</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">do</span><span class="pln">
    IP_ADDRESS</span><span class="pun">=</span><span class="pln">$</span><span class="pun">(</span><span class="pln">gcloud compute instances describe $machine </span><span class="pun">--</span><span class="pln">zone</span><span class="pun">=</span><span class="pln">$ZONE </span><span class="pun">--</span><span class="pln">format</span><span class="pun">=</span><span class="str">'value(networkInterfaces.accessConfigs[].natIP)'</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> sed </span><span class="str">"s/\['//g"</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> sed </span><span class="str">"s/'\]//g"</span><span class="pln"> </span><span class="pun">)/</span><span class="lit">32</span><span class="pln">
    echo </span><span class="str">"IP address of $machine is $IP_ADDRESS"</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">[</span><span class="pln"> </span><span class="pun">-</span><span class="pln">z  $ips </span><span class="pun">];</span><span class="pln"> </span><span class="kwd">then</span><span class="pln">
       ips</span><span class="pun">=</span><span class="pln">$IP_ADDRESS
    </span><span class="kwd">else</span><span class="pln">
       ips</span><span class="pun">=</span><span class="str">"$ips,$IP_ADDRESS"</span><span class="pln">
    </span><span class="kwd">fi</span><span class="pln">
</span><span class="kwd">done</span><span class="pln">

echo </span><span class="str">"Authorizing [$ips] to access cloudsql=$CLOUDSQL"</span><span class="pln">
gcloud sql instances patch $CLOUDSQL </span><span class="pun">--</span><span class="pln">authorized</span><span class="pun">-</span><span class="pln">networks $ips</span></code><button class="button button--text button--small copy-button js-copy-button-15"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="11">
<li>
<p>Press <strong>ENTER</strong>. When prompted, type <strong>Y</strong>, then press <strong>ENTER</strong> again to continue.</p>
</li>
<li>
<p>Wait for the patching to complete. You will see the following:</p>
</li>
</ol>
<pre><code>Patching Cloud SQL instance...done.
</code><button class="button button--text button--small copy-button js-copy-button-16"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="13">
<li>On the main Cloud SQL page, under <strong>Connect to this instance</strong>, copy your <strong>Public IP Address</strong> to your clipboard. (Alternatively, write it down because you're using it next.)</li>
</ol>
<p><img alt="copypublicip" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/GQxqcJEDZ6HF44xr10q3_bCD90EJzoUfnNzUQzPppJ0="></p>

<h2 id="step9">Task 7. Run the ML model</h2>
<p>Next, you create a trained model and apply it to all the users in the system. Your data science team has created a recommendation model using Apache Spark and is written in Python. Copy it over into your staging bucket.</p>
<ol>
<li>Copy over the model code by executing the below commands in Cloud Shell:</li>
</ol>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gsutil cp gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">training</span><span class="pun">/</span><span class="pln">bdml</span><span class="pun">/</span><span class="pln">v2</span><span class="pun">.</span><span class="lit">0</span><span class="pun">/</span><span class="pln">model</span><span class="pun">/</span><span class="pln">train_and_apply</span><span class="pun">.</span><span class="pln">py train_and_apply</span><span class="pun">.</span><span class="pln">py
cloudshell edit train_and_apply</span><span class="pun">.</span><span class="pln">py</span></code><button class="button button--text button--small copy-button js-copy-button-17"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="2">
<li>
<p>When prompted, select <strong>Open in New Window</strong>.</p>
</li>
<li>
<p>Wait for the Editor UI to load.</p>
</li>
<li>
<p>Open the <code>train_and_apply.py</code> file, find line 30: <strong>CLOUDSQL_INSTANCE_IP</strong>, and paste the Cloud SQL IP address you copied earlier.</p>
</li>
</ol>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="com"># MAKE EDITS HERE</span><span class="pln">
CLOUDSQL_INSTANCE_IP </span><span class="pun">=</span><span class="pln"> </span><span class="str">'&lt;paste-your-cloud-sql-ip-here&gt;'</span><span class="pln">   </span><span class="com"># &lt;---- CHANGE (database server IP)</span><span class="pln">
CLOUDSQL_DB_NAME </span><span class="pun">=</span><span class="pln"> </span><span class="str">'recommendation_spark'</span><span class="pln"> </span><span class="com"># &lt;--- leave as-is</span><span class="pln">
CLOUDSQL_USER </span><span class="pun">=</span><span class="pln"> </span><span class="str">'root'</span><span class="pln">  </span><span class="com"># &lt;--- leave as-is</span><span class="pln">
CLOUDSQL_PWD  </span><span class="pun">=</span><span class="pln"> </span><span class="str">'&lt;type-your-cloud-sql-password-here&gt;'</span><span class="pln">  </span><span class="com"># &lt;---- CHANGE</span></code><button class="button button--text button--small copy-button js-copy-button-18"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="5">
<li>
<p>Find line 33: <strong>CLOUDSQL_PWD</strong> and type in your Cloud SQL password,</p>
</li>
<li>
<p>The editor will autosave but to be sure, select <strong>File &gt; Save</strong>.</p>
</li>
<li>
<p>From the Cloud Shell ribbon, click on the <strong>Open Terminal</strong> icon and copy this file to your Cloud Storage bucket using this Cloud Shell command:</p>
</li>
</ol>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gsutil cp train_and_apply</span><span class="pun">.</span><span class="pln">py gs</span><span class="pun">://</span><span class="pln">$DEVSHELL_PROJECT_ID</span></code><button class="button button--text button--small copy-button js-copy-button-19"><ql-icon>content_copy</ql-icon></button></pre>
<h2 id="step10">Task 8. Run your ML job on Dataproc</h2>
<ol>
<li>
<p>In the <strong>Dataproc</strong> console, click <strong>rentals</strong> cluster.</p>
</li>
<li>
<p>Click <strong>Submit job</strong>.</p>
</li>
<li>
<p>For <strong>Job type</strong>, select <strong>PySpark</strong> and for <strong>Main python file</strong>, specify the location of the Python file you uploaded to your bucket. Your <code>&lt;bucket-name&gt;</code> is likely to be your Project ID, which you can find by clicking on the Project ID dropdown in the top navigation menu.</p>
<p><img alt="e15bafe2c29956b5.png" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/ZXUqBAvJllcO09HWGJTJeYw_gimAj++oU_GwmaHJHU0="></p>
<p><code>gs://&lt;bucket-name&gt;/train_and_apply.py</code></p>
</li>
<li>
<p>For <strong>Max restarts per hour</strong>, enter <strong>1</strong>.</p>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
</li>
<li>
<p>Select <strong>Navigation menu &gt; Dataproc &gt; Job</strong> tab to see the Job status.</p>
</li>
</ol>
<ql-infobox><strong>Note:</strong> It will take up to 5 minutes for the job to change from `Running` to `Succeeded`. You can continue to the next section on querying the results while the job runs.

 

If the job `Failed`, please troubleshoot using the logs and fix the errors. You may need to re-upload the changed Python file to Cloud Storage and clone the failed job to resubmit.</ql-infobox>

<h2 id="step11">Task 9. Explore inserted rows with SQL</h2>
<ol>
<li>
<p>In a new browser tab, open <strong>SQL</strong> (in the Storage section).</p>
</li>
<li>
<p>Click <strong>rentals</strong> to view details related to your Cloud SQL instance.</p>
</li>
<li>
<p>Under <strong>Connect to this instance</strong> section, click <strong>Connect using Cloud Shell</strong>. This will start a new Cloud Shell tab. In the Cloud Shell tab press <strong>ENTER</strong>.</p>
<p>It will take a few minutes to allow your IP for the incoming connection.</p>
</li>
<li>
<p>When prompted, type the root password you configured, then press <strong>ENTER</strong>.</p>
</li>
<li>
<p>At the mysql prompt, type:</p>
</li>
</ol>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="pln">USE recommendation_spark</span><span class="pun">;</span><span class="pln">

SELECT COUNT</span><span class="pun">(*)</span><span class="pln"> AS count FROM </span><span class="typ">Recommendation</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-20"><ql-icon>content_copy</ql-icon></button></pre>
<p>If you are getting an Empty Set (0) - wait for your Dataproc job to complete. If it's been more than 5 minutes, your job has likely failed and will require troubleshooting.</p>
<p>Tip: You can use the up arrow in Cloud Shell to return your previous command (or query in this case)</p>
<p><ql-multiple-choice-probe answerindex="0" optiontitles="[
&quot;125&quot;,
&quot;100&quot;,
&quot;50&quot;                      
]" shuffle="" stem="How many recommendations did the model provide?">
</ql-multiple-choice-probe></p>
<ol start="6">
<li>
<p>Find the recommendations for a user:</p>
</li>
</ol>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="pln">SELECT
    r</span><span class="pun">.</span><span class="pln">userid</span><span class="pun">,</span><span class="pln">
    r</span><span class="pun">.</span><span class="pln">accoid</span><span class="pun">,</span><span class="pln">
    r</span><span class="pun">.</span><span class="pln">prediction</span><span class="pun">,</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">title</span><span class="pun">,</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">location</span><span class="pun">,</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">price</span><span class="pun">,</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">rooms</span><span class="pun">,</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">rating</span><span class="pun">,</span><span class="pln">
    a</span><span class="pun">.</span><span class="pln">type
FROM </span><span class="typ">Recommendation</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> r
JOIN </span><span class="typ">Accommodation</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> a
ON r</span><span class="pun">.</span><span class="pln">accoid </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">.</span><span class="pln">id
WHERE r</span><span class="pun">.</span><span class="pln">userid </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span></code><button class="button button--text button--small copy-button js-copy-button-21"><ql-icon>content_copy</ql-icon></button></pre>
<ol start="7">
<li>
<p>Your result should be similar to the below result:</p>
</li>
</ol>
<pre><code>+--------+--------+------------+-----------------------------+...
| userid | accoid | prediction | title                       |...
+--------+--------+------------+-----------------------------+...
| 10     | 41     |  1.7748766 | Big Calm Manor              |...
| 10     | 21     |  1.7174504 | Big Peaceful Cabin          |...
| 10     | 46     |  1.7159091 | Colossal Private Castle     |...
| 10     | 31     |  1.5783813 | Colossal Private Castle     |...
| 10     | 32     |  1.5584077 | Immense Private Hall        |...
+--------+--------+------------+-----------------------------+...
</code><button class="button button--text button--small copy-button js-copy-button-22"><ql-icon>content_copy</ql-icon></button></pre>
<p>These are the five accommodations that you would recommend. Note that the quality of the recommendations is not great because the dataset was so small (note that the predicted ratings are not very high). Still, this lab illustrates the process you'd go through to create product recommendations.</p>
<h3>Congratulations!</h3>
<p>You have populated rentals data in Cloud SQL for the rentals recommendation engine to use.</p>
<h3>Recap:</h3>
<p>In this lab, you:</p>
<ul>
<li>Created a fully-managed Cloud SQL instance for rentals</li>
<li>Created tables and explored the schema with SQL</li>
<li>Ingested data from CSVs</li>
<li>Edited and ran a Spark ML job on Dataproc</li>
<li>Viewed prediction results</li>
</ul>
<h2 id="step12">End your lab</h2>
<p>When you have completed your lab, click <strong>End Lab</strong>. Qwiklabs removes the resources you’ve used and cleans the account for you.</p>
<p>You will be given an opportunity to rate the lab experience. Select the applicable number of stars, type a comment, and then click <strong>Submit</strong>.</p>
<p>The number of stars indicates the following:</p>
<ul>
<li>1 star = Very dissatisfied</li>
<li>2 stars = Dissatisfied</li>
<li>3 stars = Neutral</li>
<li>4 stars = Satisfied</li>
<li>5 stars = Very satisfied</li>
</ul>
<p>You can close the dialog box if you don't want to provide feedback.</p>
<p>For feedback, suggestions, or corrections, please use the <strong>Support</strong> tab.</p>

<p>Copyright 2021 Google LLC All rights reserved. Google and the Google logo are trademarks of Google LLC. All other company and product names may be trademarks of the respective companies with which they are associated.</p>



</div>
</div>


<div class="hidden js-end-lab-button-container lab-content__end-lab-button">
<ql-lab-control-button class="js-end-lab-button" running=""></ql-lab-control-button>
</div>
<!-- / TODO: Move recommendations into the end lab modal -->
</ql-drawer-content>
<ql-drawer end="" id="outline-drawer" open="" slot="drawer" width="320" style="width: 320px;">
<div class="js-lab-content-outline lab-content__outline">
<a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step1">Overview</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step2">Set up your environments</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step3">Task 1. Create a Cloud SQL instance</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step4">Task 2. Create tables</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step5">Task 3. Stage data in Cloud Storage</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step6">Task 4. Load data from Cloud Storage into Cloud SQL tables</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step7">Task 5. Explore Cloud SQL data</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step8">Task 6. Launch Dataproc</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step9">Task 7. Run the ML model</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step10">Task 8. Run your ML job on Dataproc</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step11">Task 9. Explore inserted rows with SQL</a><a href="https://googlecoursera.qwiklabs.com/focuses/16187025?parent=lti_session#step12">End your lab</a>
</div>
</ql-drawer>
</ql-drawer-container>
</ql-drawer-content>
</ql-drawer-container>
<div class="lab-introduction js-lab-introduction is-hidden">
<div class="lab-introduction__inner">
<h1 class="headline-1">Welcome to Your First Lab!</h1>
<ql-icon-button class="js-skip-button">close</ql-icon-button>
<div class="lab-introduction__video">
<iframe allow="autoplay; encrypted-media" allowfullscreen="" frameborder="0" id="lab-introduction" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/yF7EDXKTmoQ.html" data-gtm-yt-inspected-1_25="true"></iframe>
</div>
<a class="js-skip-button button button--outline">Skip this video</a>
</div>
</div>



</div>
</main>


<div class="modal fade" id="lab-details-modal">
<div class="modal-container">
<div class="mdl-shadow--24dp modal-content">
<div class="modal-body">
<p class="l-mbm">
In this lab, you populate rentals data in Cloud SQL for the rentals recommendation engine to use. The recommendations engine itself will run on Dataproc using Spark ML.
</p>
<p class="small-label l-mbs">
<strong>
Duration:
</strong>
0m setup
·
90m access
·
80m completion
</p>
<p class="small-label l-mbs">
<span><strong>Levels: </strong>introductory</span>
</p>
<p class="small-label">
<strong>
Permalink:
</strong>
<a href="https://googlecoursera.qwiklabs.com/catalog_lab/1794">https://googlecoursera.qwiklabs.com/catalog_lab/1794</a>
</p>
</div>
<div class="modal-actions">
<a class="button button--text" data-dismiss="modal">
Got It
</a>
</div>


</div>
</div>
<iframe class="l-ie-iframe-fix" __idm_frm__="613" data-gtm-yt-inspected-1_25="true" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/saved_resource(6).html"></iframe>
</div>
<div class="modal fade" id="lab-review-modal">
<div class="modal-container">
<div class="mdl-shadow--24dp modal-content">
<form class="simple_form js-lab-review-form" id="edit_lab_review_12986937" action="https://googlecoursera.qwiklabs.com/lab_reviews/12986937" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="_method" value="patch"><div class="modal-body">
<p class="label">
How satisfied are you with this lab?*
</p>
<div class="rateit js-rateit" data-rateit-max="5" data-rateit-min="0" data-rateit-resetable="false" data-rateit-step="1" data-rateit-value="5"><div class="rateit-reset" style="display: none;"></div><div class="rateit-range" style="width: 80px; height: 16px;"><div class="rateit-selected" style="height: 16px; width: 80px;"></div><div class="rateit-hover" style="height:16px"></div></div></div>
<div class="l-mtm">

<div class="control-group hidden lab_review_user_id"><div class="controls"><input class="hidden" type="hidden" value="5037645" name="lab_review[user_id]" id="lab_review_user_id"></div></div>
<div class="control-group hidden lab_review_classroom_id"><div class="controls"><input class="hidden" type="hidden" name="lab_review[classroom_id]" id="lab_review_classroom_id"></div></div>
<div class="control-group hidden lab_review_lab_id"><div class="controls"><input class="hidden" type="hidden" value="1794" name="lab_review[lab_id]" id="lab_review_lab_id"></div></div>
<div class="control-group hidden lab_review_focus_id"><div class="controls"><input class="hidden" type="hidden" name="lab_review[focus_id]" id="lab_review_focus_id"></div></div>
<div class="control-group hidden lab_review_rating"><div class="controls"><input class="hidden js-rating-input" type="hidden" value="2" name="lab_review[rating]" id="lab_review_rating"></div></div>
<div class="control-group text optional lab_review_comment"><label class="text optional control-label" for="lab_review_comment">Comment</label><div class="controls"><textarea class="text optional" name="lab_review[comment]" id="lab_review_comment"></textarea></div></div>
</div>
</div>
<div class="modal-actions">
<a class="button button--text" data-dismiss="modal">
Cancel
</a>
<input type="submit" name="commit" value="Submit" disabled="disabled" id="submit" data-disabled="false" class="button" data-disable-with="Submit">
</div>
</form>

</div>
</div>
<iframe class="l-ie-iframe-fix" __idm_frm__="614" data-gtm-yt-inspected-1_25="true" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/saved_resource(7).html"></iframe>
</div>


<script>
  $( function() {
    ql.initMaterialInputs();
    initChosen();
    initSearch();
    initTabs();
    ql.list.init();
    ql.favoriting.init();
    ql.header.myAccount.init();
    initTooltips();
    ql.autocomplete.init();
    ql.modals.init();
    ql.toggleButtons.init();
    ql.analytics.init();
    ql.labControlPanel.addRecaptchaErrorHandler();
  initLabContent();
  ql.labOutline.links.init();
  initLabReviewModal();
  ql.labAssessment.init();
  ql.labIntroduction.init( true );
  ql.labData.init();
  initLabTranslations( {"are_you_sure":"All done? If you end this lab, you will lose all your work. You may not be able to restart the lab if there is a quota limit. Are you sure you want to end this lab?\n","in_progress":"*In Progress*","ending":"*Ending*","starting":"*Starting, please wait*","end_concurrent_labs":"Sorry, you can only run one lab at a time. To start this lab, please confirm that you want all of your existing labs to end.\n","copied":"Copied","no_resource":"Error retrieving resource.","no_support":"No Support","mac_press":"Press ⌘-C to copy","thanks_review":"Thanks for reviewing this lab.","windows_press":"Press Ctrl-C to copy","days":"days"} );
  ql.labRun.init();
  ql.chat.init();
  ql.initHeader();
  ql.navigation.init();
  ql.navPanel.init();
  ql.navigation.init();
  
  });
</script>




<div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s ease 0s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe title="reCAPTCHA" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/anchor(2).html" width="256" height="60" role="presentation" name="a-3sefwku13hb1" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox" data-gtm-yt-inspected-1_25="true"></iframe></div><div class="grecaptcha-error"></div><textarea id="g-recaptcha-response-100000" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div></div><iframe data-product="web_widget" title="No content" tabindex="-1" aria-hidden="true" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/saved_resource(8).html" __idm_frm__="619" data-gtm-yt-inspected-1_25="true" style="width: 0px; height: 0px; border: 0px; position: absolute; top: -9999px;"></iframe><div><iframe title="Opens a widget where you can chat to one of our agents" id="launcher" tabindex="-1" __idm_frm__="622" data-gtm-yt-inspected-1_25="true" style="width: 107px; height: 50px; padding: 0px; margin: 10px 20px; position: fixed; bottom: 30px; overflow: visible; opacity: 0; border: 0px; z-index: 999998; transition-duration: 250ms; transition-timing-function: cubic-bezier(0.645, 0.045, 0.355, 1); transition-property: opacity, top, bottom; top: -9999px; visibility: hidden;" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/saved_resource(9).html"></iframe></div><div style="background-color: rgb(255, 255, 255); border: 1px solid rgb(204, 204, 204); box-shadow: rgba(0, 0, 0, 0.2) 2px 2px 3px; position: absolute; transition: visibility 0s linear 0.3s, opacity 0.3s linear 0s; opacity: 0; visibility: hidden; z-index: 2000000000; left: 0px; top: -10000px;"><div style="width: 100%; height: 100%; position: fixed; top: 0px; left: 0px; z-index: 2000000000; background-color: rgb(255, 255, 255); opacity: 0.05;"></div><div class="g-recaptcha-bubble-arrow" style="border: 11px solid transparent; width: 0px; height: 0px; position: absolute; pointer-events: none; margin-top: -11px; z-index: 2000000000;"></div><div class="g-recaptcha-bubble-arrow" style="border: 10px solid transparent; width: 0px; height: 0px; position: absolute; pointer-events: none; margin-top: -10px; z-index: 2000000000;"></div><div style="z-index: 2000000000; position: relative;"><iframe title="recaptcha challenge" src="./Recommending Products Using Cloud SQL and Spark _ Qwiklabs_files/bframe.html" name="c-ecvswh7u8y4h" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox" style="width: 100%; height: 100%;" data-gtm-yt-inspected-1_25="true"></iframe></div></div></body></html>